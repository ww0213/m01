<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="stylesheet" href="style.css">
<title>Orientation + Motion + GPS Demo</title>
</head>

<body>
<h1>è€å¸«ä½ å¥½~ æˆ‘å°‡ä½œæ¥­1èˆ‡2æ•´åˆåœ¨ä¸€èµ·</h1>
<h2>ğŸ“± DeviceOrientation + DeviceMotion + GPS</h2>
<p style="text-align:center; color:#555; margin-bottom:25px;">
    è«‹æŒ‰ä¸‹æˆæ¬ŠæŒ‰éˆ•å¾Œï¼Œæ—‹è½‰ / æ–å‹•æ‰‹æ©Ÿï¼Œä¸¦å…è¨±å®šä½ã€‚
</p>

<button id="btn">å–å¾—æ„Ÿæ¸¬å™¨èˆ‡å®šä½æˆæ¬Š</button>

<!-- GPS -->
<div class="card">
    <h3>åœ°ç†ä½ç½®ï¼ˆGPSï¼‰</h3>
    <div class="val-row"><span class="val-title">ç·¯åº¦</span><span id="lat" class="val">-</span></div>
    <div class="val-row"><span class="val-title">ç¶“åº¦</span><span id="lng" class="val">-</span></div>
    <div class="val-row"><span class="val-title">æµ·æ‹”</span><span id="alt" class="val">-</span></div>
</div>

<!-- Orientation -->
<div class="card">
    <h3>DeviceOrientationï¼ˆæ–¹å‘è§’åº¦ï¼‰</h3>
    <div class="val-row"><span class="val-title">Alpha (Z)</span><span id="alpha" class="val">-</span></div>
    <div class="val-row"><span class="val-title">Beta (X)</span><span id="beta" class="val">-</span></div>
    <div class="val-row"><span class="val-title">Gamma (Y)</span><span id="gamma" class="val">-</span></div>
</div>

<!-- Motion -->
<div class="card">
    <h3>DeviceMotionï¼ˆåŠ é€Ÿåº¦ / ç„¡é‡åŠ›ï¼‰</h3>
    <div class="val-row"><span class="val-title">ax</span><span id="ax" class="val">-</span></div>
    <div class="val-row"><span class="val-title">ay</span><span id="ay" class="val">-</span></div>
    <div class="val-row"><span class="val-title">az</span><span id="az" class="val">-</span></div>
</div>

<div class="card">
    <h3>DeviceMotionï¼ˆåŠ é€Ÿåº¦ / å«é‡åŠ›ï¼‰</h3>
    <div class="val-row"><span class="val-title">ax_g</span><span id="ax_g" class="val">-</span></div>
    <div class="val-row"><span class="val-title">ay_g</span><span id="ay_g" class="val">-</span></div>
    <div class="val-row"><span class="val-title">az_g</span><span id="az_g" class="val">-</span></div>
</div>

<!-- Rotation -->
<div class="card">
    <h3>Gyroscopeï¼ˆæ—‹è½‰é€Ÿç‡ï¼‰</h3>
    <div class="val-row"><span class="val-title">Î±</span><span id="rAlpha" class="val">-</span></div>
    <div class="val-row"><span class="val-title">Î²</span><span id="rBeta" class="val">-</span></div>
    <div class="val-row"><span class="val-title">Î³</span><span id="rGamma" class="val">-</span></div>
</div>

<script>
const btn = document.getElementById("btn");

const alphaEl = document.getElementById("alpha");
const betaEl  = document.getElementById("beta");
const gammaEl = document.getElementById("gamma");

const axEl = document.getElementById("ax");
const ayEl = document.getElementById("ay");
const azEl = document.getElementById("az");

const axgEl = document.getElementById("ax_g");
const aygEl = document.getElementById("ay_g");
const azgEl = document.getElementById("az_g");

const rAlphaEl = document.getElementById("rAlpha");
const rBetaEl  = document.getElementById("rBeta");
const rGammaEl = document.getElementById("rGamma");

const latEl = document.getElementById("lat");
const lngEl = document.getElementById("lng");
const altEl = document.getElementById("alt");

// GPS Promise
function getGeoLocation() {
    return new Promise((resolve, reject) => {
        navigator.geolocation.getCurrentPosition(
            pos => {
                const c = pos.coords;
                resolve({
                    latitude: c.latitude,
                    longitude: c.longitude,
                    altitude: c.altitude ?? "æœªçŸ¥"
                });
            },
            err => reject(err.message),
            { enableHighAccuracy: true }
        );
    });
}

btn.addEventListener("click", async () => {

    // 1. Orientation Permission
    if (typeof DeviceOrientationEvent?.requestPermission === "function") {
        const res = await DeviceOrientationEvent.requestPermission();
        if (res !== "granted") {
            alert("æœªå…è¨±æ–¹å‘æ„Ÿæ¸¬å™¨");
            return;
        }
    }

    // 2. Motion Permission
    if (typeof DeviceMotionEvent?.requestPermission === "function") {
        const res = await DeviceMotionEvent.requestPermission();
        if (res !== "granted") {
            alert("æœªå…è¨±åŠ é€Ÿåº¦æ„Ÿæ¸¬å™¨");
            return;
        }
    }

    // 3. GPS
    try {
        const geo = await getGeoLocation();
        latEl.textContent = geo.latitude;
        lngEl.textContent = geo.longitude;
        altEl.textContent = geo.altitude;
    } catch (err) {
        alert("å®šä½å¤±æ•—ï¼š" + err);
    }

    // 4. Orientation Listener
    window.addEventListener("deviceorientation", (event) => {
        alphaEl.textContent = event.alpha?.toFixed(2) ?? "-";
        betaEl.textContent  = event.beta?.toFixed(2) ?? "-";
        gammaEl.textContent = event.gamma?.toFixed(2) ?? "-";
    });

    // 5. Motion Listener
    window.addEventListener("devicemotion", (event) => {
        const acc = event.acceleration || {};
        axEl.textContent = acc.x?.toFixed(2) ?? "-";
        ayEl.textContent = acc.y?.toFixed(2) ?? "-";
        azEl.textContent = acc.z?.toFixed(2) ?? "-";

        const accG = event.accelerationIncludingGravity || {};
        axgEl.textContent = accG.x?.toFixed(2) ?? "-";
        aygEl.textContent = accG.y?.toFixed(2) ?? "-";
        azgEl.textContent = accG.z?.toFixed(2) ?? "-";

        const rot = event.rotationRate || {};
        rAlphaEl.textContent = rot.alpha?.toFixed(2) ?? "-";
        rBetaEl.textContent  = rot.beta?.toFixed(2) ?? "-";
        rGammaEl.textContent = rot.gamma?.toFixed(2) ?? "-";
    });

    btn.disabled = true;
    btn.textContent = "æ„Ÿæ¸¬å™¨å·²å•Ÿå‹•";
});
</script>
</body>
</html>
